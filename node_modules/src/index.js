//create one existing route or one single route and then make sure that our Express server
//listens to some port on our local machine will then use our Web browser to test out that little test
//route and make sure that we can get some content to appear.


const express = require('express');
//import library mongoose:
const mongoose = require('mongoose');
// require - a way to import
const authRoutes = require('./routes/authRoutes');
// the app declaration.
const app = express();

//associates all the request handlers we added to the router with our main express application:
app.use(authRoutes);

//with mongoUri connect to our mongo instance :
const mongoUri = 'mongodb+srv://natasha:RU1701981@cluster0-pz16w.mongodb.net/test?retryWrites=true&w=majority'; //mongodb+srv://natasha:<password>@cluster0-pz16w.mongodb.net/test?retryWrites=true&w=majority
//mongodb://natasha:<password>@cluster0-shard-00-00-pz16w.mongodb.net:27017,cluster0-shard-00-01-pz16w.mongodb.net:27017,cluster0-shard-00-02-pz16w.mongodb.net:27017/<dbname>?ssl=true&replicaSet=Cluster0-shard-0&authSource=admin&retryWrites=true&w=majority

mongoose.connect(mongoUri, {
    useNewUrlParser: true,
    useCreateIndex: true,
    useUnifiedTopology: true
});

mongoose.connection.on('conected', ()=> {
    console.log('Connected to mongo instance');
});
mongoose.connection.on('error', err => {
    console.error('Error connecing to mongo', err);
});

//1st root handler-
/*
anytime someone makes a 'get' type HTTP request to the root route of our application - the function gets called automatically with a request
object or an object that represents the incoming HTTP request and a res object which represents the outgoing response so in this case we'll just 
send back a little bit of plain text to whoever made this request.
*/
app.get('/', (req, res) => {
    res.send('Hi, there!');
}); 

// 2 root handler-
/*
to get this (above) working we're gonna have our app object with our Express application listen to a certain port on our local machine.
*/
 app.listen(3002, () => {
     console.log('Listening on port 3002');
 });
